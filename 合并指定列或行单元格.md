package com.feisuanyz.function;
import com.feisuanyz.flow.core.cmpt.annotation.function.MethodDesc;
import com.feisuanyz.flow.core.cmpt.annotation.function.ParamDesc;

import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class FunTest {
    
@MethodDesc(desc = "合并指定列或行单元格",
params = {
@ParamDesc(name = "filePath", desc = "文件路径"),
})
public static void mergeCells(String filePath) throws IOException {
        FileInputStream fileInputStream = new FileInputStream(filePath);
        Workbook workbook = new XSSFWorkbook(fileInputStream);
        Sheet sheet = workbook.getSheetAt(0);

        // 合并第一列的单元格
        CellRangeAddress cellRangeAddress = new CellRangeAddress(0, sheet.getLastRowNum(), 0, 0);
        sheet.addMergedRegion(cellRangeAddress);

        // 合并第一行的单元格
        CellRangeAddress cellRangeAddress2 = new CellRangeAddress(0, 0, 0, sheet.getRow(0).getLastCellNum() - 1);
        sheet.addMergedRegion(cellRangeAddress2);

        FileOutputStream fileOutputStream = new FileOutputStream(filePath);
        workbook.write(fileOutputStream);
        fileOutputStream.close();
        workbook.close();
    }
}
